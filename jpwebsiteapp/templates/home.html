{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/home.css' %}" />
{% endblock %}
{% block content %}
  <!-- Hero Section - Modern Fullscreen Carousel -->
  <section id="hero" class="hero-section">
    <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="4500">
      <!-- Indicators -->
      <div class="carousel-indicators">
        {% for slide in hero_slides %}
        <button type="button" data-bs-target="#heroCarousel"
                data-bs-slide-to="{{ forloop.counter0 }}"
                class="{% if forloop.first %}active{% endif %}"
                aria-label="Slide {{ forloop.counter }}"></button>
        {% endfor %}
      </div>

      <!-- Slides -->
      <div class="carousel-inner">
        {% for slide in hero_slides %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <div class="hero-gradient-overlay"></div>
          <img src="{{ slide.image.url }}" class="d-block w-100 hero-image" alt="{{ slide.title_part_one }} {{ slide.title_part_two }}">

          <!-- Caption Container -->
          <div class="carousel-caption">
            <div class="hero-caption-content" data-aos="fade-up" data-aos-delay="300">
              <div class="container">
                <div class="row justify-content-center">
                  <div class="col-lg-10">
                    <h1 class="hero-title mb-4">
                      <span class="hero-title-part">{{ slide.title_part_one }}</span>
                      <span class="hero-title-accent">{{ slide.title_part_two }}</span>
                    </h1>
                    <div class="hero-buttons">
                      <a href="{{ slide.button_primary_url }}" class="btn btn-jubilee-primary btn-lg px-4 py-2">
                        {{ slide.button_primary_text }}
                      </a>
                      <a href="{{ slide.button_secondary_url }}" class="btn btn-jubilee-outline btn-lg px-4 py-2">
                        {{ slide.button_secondary_text }}
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </section>
  <!-- Join Section - Modern Card Layout with AOS -->
  <section id="join-section"
           class="join-section py-6 bg-light position-relative">
    <div class="container position-relative z-2">
      <!-- Section Header -->
      <div class="section-header text-center mb-5" data-aos="fade-up">
        <div class="d-flex justify-content-center mb-3">
          <div class="divider-top bg-danger"></div>
        </div>
        <h2 class="display-4 fw-bold mb-3">FORM NI JUBILEE</h2>
        <p class="lead fw-bold">Join the winning team today!</p>
      </div>
      <!-- Cards Row -->
      <div class="row g-4 justify-content-center">
        <!-- Aspirant Card -->
        <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="100">
          <div class="card join-card h-100 border-0">
            <div class="card-body text-center p-4 p-lg-5">
              <div class="icon-wrapper bg-opacity-10 mb-4">
                <i class="fas fa-user-tie fa-2x"></i>
              </div>
              <h3 class="card-title h4 fw-bold mb-3">Aspiring Candidate?</h3>
              <p class="card-text text-muted mb-4">
                Join the party with guaranteed transparent nominations and equal
                opportunities for all.
              </p>
              <a href="https://membership.jubileeparty.ke/"
                 class="btn btn-danger btn-hover-light stretched-link px-4">
                Nomination Application <i class="fas fa-arrow-right ms-2"></i>
              </a>
            </div>
          </div>
        </div>
        <!-- Member Card -->
        <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="200">
          <div class="card join-card h-100 border-0">
            <div class="card-body text-center p-4 p-lg-5">
              <div class="icon-wrapper bg-opacity-10 mb-4">
                <i class="fas fa-users fa-2x"></i>
              </div>
              <h3 class="card-title h4 fw-bold mb-3">Become a Member</h3>
              <p class="card-text text-muted mb-4">
                Register as a Jubilee member and be part of Kenya's transformation
                journey.
              </p>
              <a href="https://membership.jubileeparty.ke/"
                 class="btn btn-danger btn-hover-light stretched-link px-4">
                Register Now <i class="fas fa-arrow-right ms-2"></i>
              </a>
            </div>
          </div>
        </div>
        <!-- Volunteer Card -->
        <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="300">
          <div class="card join-card h-100 border-0">
            <div class="card-body text-center p-4 p-lg-5">
              <div class="icon-wrapper bg-opacity-10 mb-4">
                <i class="fas fa-hands-helping fa-2x"></i>
              </div>
              <h3 class="card-title h4 fw-bold mb-3">Volunteer</h3>
              <p class="card-text text-muted mb-4">Contribute your time and skills to help build a better Kenya.</p>
              <a href="#volunteer-section"
                 class="btn btn-danger btn-hover-light stretched-link px-4">
                Volunteer Now <i class="fas fa-arrow-right ms-2"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- ✅✅✅ Highlights Section - Clean Split Layout with Fixed Ratio CSS ✅✅✅ -->
  <section id="highlight-section"
           class="highlight-section py-6 text-white position-relative overflow-hidden">
    <div class="container-fluid px-0">
      <div class="container position-relative z-2">
        <div class="row align-items-center">
          <!-- Left Text Column -->
          <div class="col-lg-5 mb-5 mb-lg-0 text-center text-lg-start"
               data-aos="fade-right">
            <div class="pe-lg-4">
              <!-- Divider + Subtitle -->
              <div class="section-divider d-flex align-items-center justify-content-center justify-content-lg-start mb-4">
                <div class="divider-line"></div>
                <h6 class="section-subtitle mb-0">Our Journey of Transformation</h6>
              </div>
              <!-- Main Headline -->
              <h1 class="section-title display-4 fw-bold mb-4 lh-sm">
                We Came.
                <br />
                We Saw.
                <br />
                We Conquered.
              </h1>
              <!-- CTA Button -->
              <a href="{% url 'achievements' %}"
                 class="btn btn-light btn-lg px-4 fw-semibold text-danger highlight-btn">
                View Achievements <i class="fas fa-arrow-right ms-2"></i>
              </a>
            </div>
          </div>
          <!-- Right Carousel Column -->
          <div class="col-lg-7" data-aos="fade-left">
            <div id="highlightCarousel"
                 class="carousel slide highlight-carousel"
                 data-bs-ride="carousel"
                 data-bs-interval="4000"
                 data-bs-touch="true">
              <div class="carousel-inner">
                {% for slide in highlight_slides %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="ratio ratio-16x9 position-relative">
                      <img src="{{ slide.image.url }}"
                           class="d-block w-100 highlight-image ratio-child"
                           alt="{{ slide.title }}"
                           width="1280"
                           height="720" />
                      <div class="highlight-caption">
                        <h5>{{ slide.title }}</h5>
                        <p>{{ slide.description }}</p>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
              <!-- Indicators -->
              <div class="carousel-indicators mt-3">
                {% for slide in highlight_slides %}
                  <button type="button"
                          data-bs-target="#highlightCarousel"
                          data-bs-slide-to="{{ forloop.counter0 }}"
                          class="{% if forloop.first %}active{% endif %}"
                          aria-label="Slide {{ forloop.counter }}"></button>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- Volunteer Section - Modern Form Layout -->
  <section id="volunteer-section" class="py-6">
    <div class="container">
      <div class="row align-items-center">

        <!-- Left Image -->
        <div class="col-lg-6 mb-5 mb-lg-0" data-aos="fade-right" data-aos-delay="0" data-aos-duration="1200">
          <img src="{% static 'party_images/volunteer.webp' %}"
              alt="Volunteer with Jubilee"
              width="800"
              height="600"
              class="img-fluid rounded-3 shadow-lg" />
        </div>

        <!-- Right Text & Form -->
        <div class="col-lg-6" data-aos="fade-left" data-aos-delay="200" data-aos-duration="1200">
          <div class="ps-lg-5">
            <h2 class="display-5 fw-bold mb-4">Make a Difference</h2>
            <p class="lead mb-4">Join our team of dedicated volunteers and help shape Kenya's future.</p>

            <div id="volunteerFormContainer">
              <button id="volunteerBtn" class="btn btn-lg px-4 py-2">
                Become a Volunteer <i class="fas fa-arrow-right ms-2"></i>
              </button>

              <div id="volunteerForm" class="mt-4">
                <div class="card border-0 shadow">
                  <div class="card-body p-4 p-md-5">
                    <h3 class="h4 mb-4">Volunteer Registration</h3>
                    <form id="volunteerRegistrationForm"
                          method="post"
                          class="needs-validation"
                          novalidate>
                      {% csrf_token %}
                      <input type="hidden" name="form_type" value="volunteer" />

                      <div class="row g-3">
                        <div class="col-md-6">
                          <label for="fullName" class="form-label">Full Name</label>
                          <input type="text"
                                class="form-control"
                                id="fullName"
                                name="fullName"
                                required />
                          <div class="invalid-feedback">Please provide your full name.</div>
                        </div>

                        <div class="col-md-6">
                          <label for="email" class="form-label">Email</label>
                          <input type="email" class="form-control" id="email" name="email" required />
                          <div class="invalid-feedback">Please provide a valid email.</div>
                        </div>

                        <div class="col-md-6">
                          <label for="phone" class="form-label">Phone</label>
                          <input type="tel" class="form-control" id="phone" name="phone" required />
                          <div class="invalid-feedback">Please provide your phone number.</div>
                        </div>

                        <div class="col-md-6">
                          <label for="location" class="form-label">Location</label>
                          <select class="form-select" id="location" name="location" required>
                            <option value="" disabled selected>Select County</option>
                            {% for county in counties %}
                              <option value="{{ county.id }}">{{ county.name }}</option>
                            {% endfor %}
                          </select>
                          <div class="invalid-feedback">Please select your county.</div>
                        </div>

                        <div class="col-12">
                          <label for="skills" class="form-label">Skills/Interests</label>
                          <textarea class="form-control"
                                    id="skills"
                                    name="skills"
                                    rows="3"
                                    required
                                    placeholder="E.g. Social media, event planning, outreach, graphic design..."></textarea>
                          <div class="invalid-feedback">Please describe your skills/interests.</div>
                        </div>
                      </div>

                      <div class="mt-4">
                        <button type="submit" class="btn btn-danger">Submit Application</button>
                        <button type="button"
                                id="closeVolunteerForm"
                                class="btn btn-outline-secondary ms-2">Cancel</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
              <!-- End Form -->
            </div>
            <!-- End Form Container -->

          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Concerns Section - Red Call to Action -->
  <section id="concerns-section"
           class="concerns-section py-6 position-relative overflow-hidden text-white">
    <div class="container position-relative z-2">
      <div class="row justify-content-center text-center">
        <div class="col-lg-8" data-aos="fade-up">
          <!-- Subtle Divider -->
          <div class="d-flex justify-content-center mb-3">
            <div class="divider-line"></div>
          </div>
          <!-- Headline -->
          <h2 class="display-4 fw-bold mb-3">Your Voice Matters</h2>
          <!-- Description -->
          <p class="lead mb-4">
            We value your thoughts and concerns. Share them with us — together,
            let’s shape the future of Jubilee!
          </p>
          <!-- CTA Button -->
          <a href="{% url 'concerns' %}" class="btn btn-lg px-5 py-3 concerns-btn">
            Share Your Thoughts <i class="fas fa-arrow-right ms-2"></i>
          </a>
        </div>
      </div>
    </div>
  </section>
  <!-- Testimonials Section - Clean Modern Carousel -->
  <section id="testimonials-section"
           class="py-6 bg-light"
           data-aos="fade-up"
           data-aos-duration="800">
    <div class="container">
      <!-- Section Header -->
      <div class="section-header text-center mb-5">
        <h2 class="display-4 fw-bold text-danger position-relative d-inline-block">
          Jubilee Testimonials
          <span class="title-underline"></span>
        </h2>
        <p class="lead text-dark opacity-75 mt-3">Hear from Kenyans whose lives have been transformed.</p>
      </div>
      <!-- Carousel -->
      <div id="testimonialCarousel"
           class="carousel slide"
           data-bs-ride="carousel"
           data-bs-touch="true">
        <div class="carousel-inner px-lg-5">
          {% for testimonial in testimonials %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <div class="testimonial-item bg-white rounded-4 p-4 p-md-5 shadow-sm text-center">
                <img src="{{ testimonial.image.url }}"
                     class="testimonial-img rounded-circle shadow mb-4"
                     alt="Testimonial Image"
                     width="120"
                     height="120" />
                <i class="fas fa-quote-left text-danger opacity-25 fa-2x mb-3"></i>
                <p class="fs-5 mb-0">"{{ testimonial.quote }}"</p>
              </div>
            </div>
          {% endfor %}
        </div>
        <!-- Indicators only -->
        <div class="carousel-indicators mt-4">
          {% for testimonial in testimonials %}
            <button type="button"
                    data-bs-target="#testimonialCarousel"
                    data-bs-slide-to="{{ forloop.counter0 }}"
                    class="{% if forloop.first %}active{% endif %}"
                    aria-label="Slide {{ forloop.counter }}"></button>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
  <!-- News Section - Responsive Mobile Image -->
  <section id="news-section"
           class="py-6 text-white position-relative overflow-hidden">
    <div class="container position-relative z-2">
      <!-- Section Header -->
      <div class="section-header text-center mb-5">
        <h2 class="display-4 fw-bold mb-3">
          Latest <span class="highlight px-3 rounded">Updates</span>
        </h2>
        <div class="divider mx-auto"></div>
      </div>
      <!-- News Carousel -->
      <div id="newsCarousel"
           class="carousel slide"
           data-bs-ride="carousel"
           data-bs-interval="5000">
        <div class="carousel-inner rounded-4 overflow-hidden shadow">
          {% for news in featured_news %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <div class="row flex-column flex-md-row g-0 align-items-stretch news-row">
                <!-- Text Content -->
                <div class="col-md-6 p-5 d-flex flex-column justify-content-center">
                  <span class="badge bg-white text-danger text-uppercase mb-3">News</span>
                  <h3 class="fw-bold display-6 mb-3">{{ news.title }}</h3>
                  <p class="lead mb-4">{{ news.summary|truncatewords:30 }}</p>
                  <a href="{% url 'news' %}" class="btn btn-light btn-lg">
                    Read More <i class="fas fa-arrow-right ms-2"></i>
                  </a>
                </div>
                <!-- Image -->
                <div class="col-md-6 position-relative news-image-wrapper">
                  {% if news.image %}
                    <div class="news-image position-absolute top-0 start-0 w-100 h-100"
                         style="background-image: url('{{ news.image.url }}')"></div>
                  {% else %}
                    <div class="news-image position-absolute top-0 start-0 w-100 h-100"
                         style="background-image: url('https://source.unsplash.com/random/800x600/?news')"></div>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
        <!-- Indicators -->
        <div class="carousel-indicators mt-4">
          {% for news in featured_news %}
            <button type="button"
                    data-bs-target="#newsCarousel"
                    data-bs-slide-to="{{ forloop.counter0 }}"
                    class="{% if forloop.first %}active{% endif %}"
                    aria-label="Slide {{ forloop.counter }}"></button>
          {% endfor %}
        </div>
      </div>
      <!-- Call to Action -->
      <div class="text-center mt-5">
        <a href="{% url 'news' %}"
           class="btn btn-outline-light btn-lg px-4 py-2">
          Browse All News <i class="fas fa-newspaper ms-2"></i>
        </a>
      </div>
    </div>
  </section>
  <!-- Events Section - Modern Card Grid -->
  <section id="events-section"
           class="py-6 bg-light position-relative overflow-hidden">
    <div class="container">
      <!-- Section Header -->
      <div class="section-header text-center mb-5">
        <h2 class="display-4 fw-bold text-danger mb-3">Upcoming Events</h2>
        <p class="lead text-muted">Join us in our activities across the country</p>
        <div class="divider mx-auto"></div>
      </div>
      <!-- Events Grid -->
      <div class="row g-4">
        {% for event in events %}
          <div class="col-md-6 col-lg-4">
            <div class="card event-card h-100 border-0 shadow-sm overflow-hidden position-relative">
              <div class="card-img-top position-relative overflow-hidden">
                <img src="{{ event.image.url }}"
                     class="img-fluid w-100"
                     alt="{{ event.title }}"
                     style="height: 220px;
                            object-fit: cover" />
                <div class="event-date bg-danger text-white text-center position-absolute top-0 start-0 m-3 rounded px-2 py-1">
                  <div class="fw-bold fs-4">{{ event.date|date:"d" }}</div>
                  <div class="small text-uppercase">{{ event.date|date:"M" }}</div>
                </div>
              </div>
              <div class="card-body">
                <h5 class="card-title fw-bold text-dark">{{ event.title }}</h5>
                <p class="mb-2 text-muted">
                  <i class="fas fa-map-marker-alt text-danger me-2"></i>{{
                  event.location }}
                </p>
                <p class="card-text text-muted">{{ event.summary|truncatewords:20 }}</p>
              </div>
              <div class="card-footer bg-transparent border-0">
                <a href="#" class="btn btn-sm btn-outline-danger">More Details</a>
              </div>
            </div>
          </div>
        {% empty %}
          <div class="col-12 text-center py-5">
            <div class="alert alert-danger bg-danger-subtle text-white mx-auto no-events-alert"
                 style="max-width: 600px">
              <i class="fas fa-calendar-check fa-2x mb-3 text-white"></i>
              <h4 class="alert-heading">No Upcoming Events</h4>
              <p>
                There are currently no scheduled events. Please check back later for
                updates!
              </p>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </section>
{% endblock %}
{% block scripts %}
  {# Show SweetAlert if success #}
  {% if volunteer_success %}
    <script>
  document.addEventListener("DOMContentLoaded", function () {
    Swal.fire({
      icon: "success",
      title: "Thank You!",
      text: "Your volunteer registration has been submitted successfully.",
      confirmButtonColor: "#e30613",
      timer: 5000,
      timerProgressBar: true,
    });
  });
    </script>
  {% endif %}
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    // === Volunteer form toggle ===
    const volunteerBtn = document.getElementById("volunteerBtn");
    const volunteerForm = document.getElementById("volunteerForm");
    const closeVolunteerForm = document.getElementById("closeVolunteerForm");

    if (volunteerBtn && volunteerForm && closeVolunteerForm) {
      volunteerBtn.addEventListener("click", () => {
        volunteerForm.style.display = "block";
        volunteerBtn.style.display = "none";
        volunteerForm.scrollIntoView({ behavior: "smooth", block: "start" });
      });

      closeVolunteerForm.addEventListener("click", () => {
        volunteerForm.style.display = "none";
        volunteerBtn.style.display = "inline-block";
      });
    }

    // === Bootstrap form validation ===
    const forms = document.querySelectorAll(".needs-validation");
    Array.prototype.slice.call(forms).forEach((form) => {
      form.addEventListener(
        "submit",
        function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add("was-validated");
        },
        false
      );
    });

    // === Carousel hover pause (optional) ===
    const carousels = document.querySelectorAll(".carousel");
    carousels.forEach((carousel) => {
      carousel.addEventListener("mouseenter", () => {
        const bsCarousel = bootstrap.Carousel.getInstance(carousel);
        if (bsCarousel) bsCarousel.pause();
      });
      carousel.addEventListener("mouseleave", () => {
        const bsCarousel = bootstrap.Carousel.getInstance(carousel);
        if (bsCarousel) bsCarousel.cycle();
      });
    });
  });
  </script>
{% endblock %}
